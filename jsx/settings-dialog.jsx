/*
Code for Import https://scriptui.joonas.me â€” (Triple click to select): 
{"items":{"item-0":{"id":0,"type":"Dialog","parentId":false,"style":{"enabled":true,"varName":"settingsExport","windowType":"Dialog","creationProps":{"su1PanelCoordinates":false,"maximizeButton":false,"minimizeButton":false,"independent":false,"closeButton":true,"borderless":false,"resizeable":false},"text":"Format Settings","preferredSize":[500,0],"margins":16,"orientation":"column","spacing":10,"alignChildren":["center","top"]}},"item-4":{"id":4,"type":"VerticalTabbedPanel","parentId":0,"style":{"enabled":true,"varName":"fileFormatsPanel","preferredSize":[0,0],"tabNavWidth":75,"margins":0,"alignment":null,"selection":6}},"item-5":{"id":5,"type":"Tab","parentId":4,"style":{"enabled":true,"varName":"optionsJPGTab","text":"JPG","orientation":"column","spacing":10,"alignChildren":["fill","top"]},"collapsed":true},"item-6":{"id":6,"type":"Tab","parentId":4,"style":{"enabled":true,"varName":"optionsAITab","text":"AI","orientation":"column","spacing":10,"alignChildren":["left","top"]},"collapsed":true},"item-7":{"id":7,"type":"Tab","parentId":4,"style":{"enabled":true,"varName":"optionsSVGTab","text":"SVG","orientation":"column","spacing":10,"alignChildren":["fill","top"]},"collapsed":true},"item-8":{"id":8,"type":"Panel","parentId":7,"style":{"enabled":true,"varName":"svgOptionsPanel","creationProps":{"borderStyle":"etched","su1PanelCoordinates":false},"text":"Options","preferredSize":[390,0],"margins":10,"orientation":"column","spacing":10,"alignChildren":["left","top"],"alignment":null}},"item-9":{"id":9,"type":"Group","parentId":0,"style":{"enabled":true,"varName":"dialogBtns","preferredSize":[480,0],"margins":0,"orientation":"row","spacing":10,"alignChildren":["right","center"],"alignment":null}},"item-10":{"id":10,"type":"Button","parentId":9,"style":{"enabled":true,"varName":"cancel","text":"Cancel","justify":"center","preferredSize":[0,0],"alignment":null,"helpTip":null}},"item-11":{"id":11,"type":"Button","parentId":9,"style":{"enabled":true,"varName":"ok","text":"Ok","justify":"center","preferredSize":[0,0],"alignment":null,"helpTip":null}},"item-12":{"id":12,"type":"Panel","parentId":6,"style":{"enabled":true,"varName":"aiOptionsPanel","creationProps":{"borderStyle":"etched","su1PanelCoordinates":false},"text":"Options","preferredSize":[390,0],"margins":10,"orientation":"column","spacing":10,"alignChildren":["left","top"],"alignment":null}},"item-13":{"id":13,"type":"Panel","parentId":5,"style":{"enabled":true,"varName":"jpgOptionsPanel","creationProps":{"borderStyle":"etched","su1PanelCoordinates":false},"text":"Options","preferredSize":[390,0],"margins":10,"orientation":"column","spacing":10,"alignChildren":["left","top"],"alignment":null}},"item-14":{"id":14,"type":"Tab","parentId":4,"style":{"enabled":true,"varName":"optionsPNGTab","text":"PNG","orientation":"column","spacing":10,"alignChildren":["fill","top"]},"collapsed":true},"item-16":{"id":16,"type":"Tab","parentId":4,"style":{"enabled":true,"varName":"optionsPDFTab","text":"PDF","orientation":"column","spacing":10,"alignChildren":["fill","top"]},"collapsed":true},"item-17":{"id":17,"type":"Panel","parentId":16,"style":{"enabled":true,"varName":"pdfOptionsPanel","creationProps":{"borderStyle":"etched","su1PanelCoordinates":false},"text":"Options","preferredSize":[390,0],"margins":10,"orientation":"column","spacing":10,"alignChildren":["left","top"],"alignment":null}},"item-18":{"id":18,"type":"Tab","parentId":4,"style":{"enabled":true,"varName":"optionsEPSTab","text":"EPS","orientation":"column","spacing":10,"alignChildren":["fill","top"]}},"item-19":{"id":19,"type":"Panel","parentId":18,"style":{"enabled":true,"varName":"epsOptionsPanel","creationProps":{"borderStyle":"etched","su1PanelCoordinates":false},"text":"Options","preferredSize":[390,0],"margins":10,"orientation":"column","spacing":10,"alignChildren":["left","top"],"alignment":null}},"item-20":{"id":20,"type":"DropDownList","parentId":22,"style":{"enabled":true,"varName":"StylingSVGDropdown","text":"DropDownList","listItems":"Internal CSS, Inline Style, Presentation Attributes","preferredSize":[0,0],"alignment":null,"selection":0,"helpTip":null}},"item-21":{"id":21,"type":"StaticText","parentId":22,"style":{"enabled":true,"varName":"StylingSVGLabel","creationProps":{"truncate":"none","multiline":false,"scrolling":false},"softWrap":false,"text":"Styling","justify":"left","preferredSize":[60,0],"alignment":null,"helpTip":null}},"item-22":{"id":22,"type":"Group","parentId":8,"style":{"enabled":true,"varName":"stylingSVGGroup","preferredSize":[55,0],"margins":0,"orientation":"row","spacing":10,"alignChildren":["left","center"],"alignment":null}},"item-24":{"id":24,"type":"StaticText","parentId":26,"style":{"enabled":true,"varName":"fontLabel","creationProps":{"truncate":"none","multiline":false,"scrolling":false},"softWrap":false,"text":"Font","justify":"left","preferredSize":[60,0],"alignment":null,"helpTip":null}},"item-25":{"id":25,"type":"DropDownList","parentId":26,"style":{"enabled":true,"varName":"FontsSVGDropdown","text":"DropDownList","listItems":"Convert To Outlines, SVG","preferredSize":[0,0],"alignment":null,"selection":0,"helpTip":null}},"item-26":{"id":26,"type":"Group","parentId":8,"style":{"enabled":true,"varName":"fontSVGGroup","preferredSize":[0,0],"margins":0,"orientation":"row","spacing":10,"alignChildren":["left","center"],"alignment":null}},"item-27":{"id":27,"type":"Group","parentId":8,"style":{"enabled":true,"varName":"imagesSVGGroup","preferredSize":[0,0],"margins":0,"orientation":"row","spacing":10,"alignChildren":["left","center"],"alignment":null}},"item-28":{"id":28,"type":"StaticText","parentId":27,"style":{"enabled":true,"varName":"ImagesSVGLabel","creationProps":{"truncate":"none","multiline":false,"scrolling":false},"softWrap":false,"text":"Images","justify":"left","preferredSize":[60,0],"alignment":null,"helpTip":null}},"item-29":{"id":29,"type":"DropDownList","parentId":27,"style":{"enabled":true,"varName":"iamgesSVGLabel","text":"DropDownList","listItems":"Preserve, Embed, Link","preferredSize":[0,0],"alignment":null,"selection":0,"helpTip":null}},"item-30":{"id":30,"type":"Group","parentId":8,"style":{"enabled":true,"varName":"decimalSVGGroup","preferredSize":[122,0],"margins":0,"orientation":"row","spacing":10,"alignChildren":["left","center"],"alignment":null}},"item-31":{"id":31,"type":"StaticText","parentId":30,"style":{"enabled":true,"varName":"decimalSVGLabel","creationProps":{"truncate":"none","multiline":false,"scrolling":false},"softWrap":false,"text":"Decimal","justify":"left","preferredSize":[60,0],"alignment":null,"helpTip":null}},"item-33":{"id":33,"type":"Group","parentId":8,"style":{"enabled":true,"varName":"optionsSVGGroup","preferredSize":[122,0],"margins":0,"orientation":"row","spacing":10,"alignChildren":["left","center"],"alignment":null}},"item-34":{"id":34,"type":"StaticText","parentId":33,"style":{"enabled":true,"varName":"spacerSVGoptions","creationProps":{"truncate":"none","multiline":false,"scrolling":false},"softWrap":false,"text":"","justify":"left","preferredSize":[60,0],"alignment":null,"helpTip":null}},"item-36":{"id":36,"type":"Checkbox","parentId":33,"style":{"enabled":true,"varName":"minimizeSVGCheckbox","text":"Minimze","preferredSize":[0,0],"alignment":null,"helpTip":null}},"item-37":{"id":37,"type":"Checkbox","parentId":33,"style":{"enabled":true,"varName":"responsiveSVGCheckbox","text":"Responsive","preferredSize":[0,0],"alignment":null,"helpTip":null}},"item-38":{"id":38,"type":"EditText","parentId":30,"style":{"enabled":true,"varName":"decimalSVGInput","creationProps":{"noecho":false,"readonly":false,"multiline":false,"scrollable":false,"borderless":false,"enterKeySignalsOnChange":false},"softWrap":false,"text":"","justify":"left","preferredSize":[65,0],"alignment":null,"helpTip":null}},"item-39":{"id":39,"type":"Group","parentId":19,"style":{"enabled":true,"varName":"versionEPSGroup","preferredSize":[55,0],"margins":0,"orientation":"row","spacing":10,"alignChildren":["left","center"],"alignment":null}},"item-40":{"id":40,"type":"StaticText","parentId":39,"style":{"enabled":true,"varName":"versionEPSLabel","creationProps":{"truncate":"none","multiline":false,"scrolling":false},"softWrap":false,"text":"Version","justify":"left","preferredSize":[60,0],"alignment":null,"helpTip":null}},"item-41":{"id":41,"type":"DropDownList","parentId":39,"style":{"enabled":true,"varName":"VersionEPSDropdown","text":"DropDownList","listItems":"Illustrator CC EPS, -,Legacy Formats,Illustrator CS6 EPS,Illustrator CS5 EPS,Illustrator CS4 EPS","preferredSize":[0,0],"alignment":null,"selection":0,"helpTip":null}},"item-42":{"id":42,"type":"Group","parentId":19,"style":{"enabled":true,"varName":"embedFontsEPSGroup","preferredSize":[55,0],"margins":0,"orientation":"column","spacing":10,"alignChildren":["left","center"],"alignment":null}},"item-43":{"id":43,"type":"Checkbox","parentId":42,"style":{"enabled":true,"varName":"embedFontsEPSCheckbox","text":"Embed Fonts","preferredSize":[0,0],"alignment":null,"helpTip":null}},"item-44":{"id":44,"type":"Checkbox","parentId":42,"style":{"enabled":true,"varName":"includeLinkedEPSCheckbox","text":"Include Linked Files","preferredSize":[0,0],"alignment":null,"helpTip":null}},"item-45":{"id":45,"type":"Checkbox","parentId":42,"style":{"enabled":true,"varName":"includeThumbsEPSCheckbox","text":"Include Document Thumbnails","preferredSize":[0,0],"alignment":null,"helpTip":null}},"item-46":{"id":46,"type":"Checkbox","parentId":42,"style":{"enabled":true,"varName":"includeCmykinRGBEPSCheckbox","text":"Include CMYK Postscript in RGB Files","preferredSize":[0,0],"alignment":null,"helpTip":null}},"item-47":{"id":47,"type":"Checkbox","parentId":42,"style":{"enabled":true,"varName":"compatiblePrintingEPSCHeckbox","text":"Compatible  Gradient and Gradient Mesh printing","preferredSize":[0,0],"alignment":null,"helpTip":null}},"item-48":{"id":48,"type":"Group","parentId":42,"style":{"enabled":true,"varName":"adobePostscriptEPSGroup","preferredSize":[0,0],"margins":0,"orientation":"row","spacing":10,"alignChildren":["left","center"],"alignment":null}},"item-49":{"id":49,"type":"StaticText","parentId":48,"style":{"enabled":true,"varName":"adobePostscripEPSLabel","creationProps":{"truncate":"none","multiline":false,"scrolling":false},"softWrap":false,"text":"Adobe PostscriptÂ®","justify":"left","preferredSize":[0,0],"alignment":null,"helpTip":null}},"item-50":{"id":50,"type":"DropDownList","parentId":48,"style":{"enabled":true,"varName":"adobePostscriptEPSDropdown","text":"DropDownList","listItems":"LanguageLevel 2, LanguageLevel 3","preferredSize":[125,0],"alignment":null,"selection":0,"helpTip":null}},"item-51":{"id":51,"type":"Group","parentId":12,"style":{"enabled":true,"varName":"versionAIGroup","preferredSize":[55,0],"margins":0,"orientation":"row","spacing":10,"alignChildren":["left","center"],"alignment":null}},"item-52":{"id":52,"type":"StaticText","parentId":51,"style":{"enabled":true,"varName":"versionAILabel","creationProps":{"truncate":"none","multiline":false,"scrolling":false},"softWrap":false,"text":"Version","justify":"left","preferredSize":[60,0],"alignment":null,"helpTip":null}},"item-53":{"id":53,"type":"DropDownList","parentId":51,"style":{"enabled":true,"varName":"VersionAIDropdown","text":"DropDownList","listItems":"Illustrator CC, -,Legacy Formats,Illustrator CS6 ,Illustrator CS5 ,Illustrator CS4 ,Illustrator CS3 ,Illustrator CS2 ,Illustrator CS ,Illustrator 10, ,Illustrator 9 ,Illustrator 8","preferredSize":[0,0],"alignment":null,"selection":0,"helpTip":null}},"item-54":{"id":54,"type":"Checkbox","parentId":12,"style":{"enabled":true,"varName":"compatibelPDFAICheckbox","text":"Create PDF Compatibel File","preferredSize":[0,0],"alignment":null,"helpTip":null}},"item-55":{"id":55,"type":"Checkbox","parentId":12,"style":{"enabled":true,"varName":"includeLinkedAICheckbox","text":"Include Linked Files","preferredSize":[0,0],"alignment":null,"helpTip":null}},"item-56":{"id":56,"type":"Checkbox","parentId":12,"style":{"enabled":true,"varName":"useCompressionAICheckbox","text":"Use Compression","preferredSize":[0,0],"alignment":null,"helpTip":null}},"item-57":{"id":57,"type":"Checkbox","parentId":12,"style":{"enabled":true,"varName":"embedICCProfilesAICheckbox","text":"Embed ICC Profiles","preferredSize":[0,0],"alignment":null,"helpTip":null}},"item-58":{"id":58,"type":"Checkbox","parentId":17,"style":{"enabled":true,"varName":"preserveEditingPDFCheckbox","text":"Preserve Illustrator  Editing Capabalities","preferredSize":[0,0],"alignment":null,"helpTip":null}},"item-59":{"id":59,"type":"Checkbox","parentId":17,"style":{"enabled":true,"varName":"embedPageThumbnailsPDFCheckbox","text":"Embed Page Thumbnails","preferredSize":[0,0],"alignment":null,"helpTip":null}},"item-60":{"id":60,"type":"Checkbox","parentId":17,"style":{"enabled":true,"varName":"optimizeFastWebPDFCheckbox","text":"Optimize for Fast Web View","preferredSize":[0,0],"alignment":null,"helpTip":null}},"item-61":{"id":61,"type":"Checkbox","parentId":17,"style":{"enabled":true,"varName":"createAcrobatLayerPDFCheckbox","text":"Create Acrobat Layers from Top-Level Layers","preferredSize":[0,0],"alignment":null,"helpTip":null}},"item-62":{"id":62,"type":"Group","parentId":17,"style":{"enabled":true,"varName":"pdfPresetPDFGroup","preferredSize":[55,0],"margins":0,"orientation":"row","spacing":10,"alignChildren":["left","center"],"alignment":null}},"item-63":{"id":63,"type":"StaticText","parentId":62,"style":{"enabled":true,"varName":"pdfPresetsPDFLabel","creationProps":{"truncate":"none","multiline":false,"scrolling":false},"softWrap":false,"text":"Adobe PDF Presets","justify":"left","preferredSize":[120,0],"alignment":null,"helpTip":null}},"item-64":{"id":64,"type":"DropDownList","parentId":62,"style":{"enabled":true,"varName":"pdfPresetsPDFDropdown","text":"DropDownList","listItems":"Illustrator CC, -,Legacy Formats,Illustrator CS6 ,Illustrator CS5 ,Illustrator CS4 ,Illustrator CS3 ,Illustrator CS2 ,Illustrator CS ,Illustrator 10, ,Illustrator 9 ,Illustrator 8","preferredSize":[0,0],"alignment":null,"selection":0,"helpTip":null}},"item-65":{"id":65,"type":"Group","parentId":13,"style":{"enabled":true,"varName":"compressionMethodJPGGroup","preferredSize":[0,0],"margins":0,"orientation":"row","spacing":10,"alignChildren":["left","center"],"alignment":null}},"item-66":{"id":66,"type":"StaticText","parentId":65,"style":{"enabled":true,"varName":"compressionMethodJPGLabel","creationProps":{"truncate":"none","multiline":false,"scrolling":false},"softWrap":false,"text":"Compression Method","justify":"left","preferredSize":[140,0],"alignment":null,"helpTip":null}},"item-67":{"id":67,"type":"DropDownList","parentId":65,"style":{"enabled":true,"varName":"compressionPresetsJPGDropdown","text":"DropDownList","listItems":"Baseline (Standard), Baseline Optimized, Progressive","preferredSize":[0,0],"alignment":null,"selection":0,"helpTip":null}},"item-68":{"id":68,"type":"Group","parentId":13,"style":{"enabled":true,"varName":"antialiasingJPGGroup","preferredSize":[0,0],"margins":0,"orientation":"row","spacing":10,"alignChildren":["left","center"],"alignment":null}},"item-69":{"id":69,"type":"StaticText","parentId":68,"style":{"enabled":true,"varName":"antialiasingJPGLabel","creationProps":{"truncate":"none","multiline":false,"scrolling":false},"softWrap":false,"text":"Anti-aliasing","justify":"left","preferredSize":[140,0],"alignment":null,"helpTip":null}},"item-70":{"id":70,"type":"DropDownList","parentId":68,"style":{"enabled":true,"varName":"antialiasingJPGDropdown","text":"DropDownList","listItems":"Type Optimized (Hinted), Art Optimized (Supersampling), None","preferredSize":[0,0],"alignment":null,"selection":0,"helpTip":null}},"item-71":{"id":71,"type":"Checkbox","parentId":13,"style":{"enabled":true,"varName":"embedICCProfilesJPGCheckbox","text":"Embed ICC Profiles","preferredSize":[0,0],"alignment":null,"helpTip":null}},"item-72":{"id":72,"type":"Group","parentId":75,"style":{"enabled":true,"varName":"antialiasingPNGGroup","preferredSize":[0,0],"margins":0,"orientation":"row","spacing":10,"alignChildren":["left","center"],"alignment":null}},"item-73":{"id":73,"type":"StaticText","parentId":72,"style":{"enabled":true,"varName":"antialiasingPNGLabel","creationProps":{"truncate":"none","multiline":false,"scrolling":false},"softWrap":false,"text":"Anit-aliasing","justify":"left","preferredSize":[120,0],"alignment":null,"helpTip":null}},"item-74":{"id":74,"type":"DropDownList","parentId":72,"style":{"enabled":true,"varName":"antialiasingPNGDropdown","text":"DropDownList","listItems":"Type Optimized (Hinted), Art Optimized (Supersampling), None","preferredSize":[0,0],"alignment":null,"selection":0,"helpTip":null}},"item-75":{"id":75,"type":"Panel","parentId":14,"style":{"enabled":true,"varName":"pngOptionsPanel","creationProps":{"borderStyle":"etched","su1PanelCoordinates":false},"text":"Options","preferredSize":[0,0],"margins":10,"orientation":"column","spacing":10,"alignChildren":["left","top"],"alignment":null}},"item-76":{"id":76,"type":"Group","parentId":75,"style":{"enabled":true,"varName":"backgroundcolorPNGGroup","preferredSize":[0,0],"margins":0,"orientation":"row","spacing":10,"alignChildren":["left","center"],"alignment":null}},"item-77":{"id":77,"type":"StaticText","parentId":76,"style":{"enabled":true,"varName":"backgroundcolorPNGLabel","creationProps":{"truncate":"none","multiline":false,"scrolling":false},"softWrap":false,"text":"Background Color","justify":"left","preferredSize":[120,0],"alignment":null,"helpTip":null}},"item-78":{"id":78,"type":"DropDownList","parentId":76,"style":{"enabled":true,"varName":"backgroundcolorPNGDropdown","text":"DropDownList","listItems":"Transparent, Black, White","preferredSize":[0,0],"alignment":null,"selection":0,"helpTip":null}},"item-79":{"id":79,"type":"Checkbox","parentId":75,"style":{"enabled":true,"varName":"interlacedPNGCheckbox","text":"Interlaced","preferredSize":[0,0],"alignment":null,"helpTip":null}}},"order":[0,4,6,12,51,52,53,54,55,57,56,7,8,22,21,20,26,24,25,27,28,29,30,31,38,33,34,36,37,16,17,62,63,64,58,59,60,61,18,19,39,40,41,42,43,44,45,46,47,48,49,50,5,13,65,66,67,68,69,70,71,14,75,72,73,74,79,76,77,78,9,10,11],"settings":{"importJSON":true,"indentSize":false,"cepExport":false,"includeCSSJS":true,"showDialog":true,"functionWrapper":false,"afterEffectsDockable":false,"itemReferenceList":"None"},"activeId":6}
*/

// ok and cancel button
var runButtonID = 1;
var cancelButtonID = 2;
var panelSpacing = 8;
var panelMargins = 16;


var extensionRoot = getExtensionRootPath();
$.evalFile(new File(extensionRoot + '/js/json2.js'));
var settingsFile = 'settings/settings.json';
var exportInfo = new Object();

function showDialog(exportInfo, extensionRoot) {
    // SETTINGSEXPORT
    // ==============
    var settingsExport = new Window("dialog");
    settingsExport.text = "Format Settings";
    settingsExport.preferredSize.width = 500;
    settingsExport.orientation = "column";
    settingsExport.alignChildren = ["center", "top"];
    settingsExport.spacing = 10;
    settingsExport.margins = 16;

    // FILEFORMATSPANEL
    // ================
    var fileFormatsPanel = settingsExport.add("group", undefined, undefined, {
        name: "fileFormatsPanel"
    });
    fileFormatsPanel.alignChildren = ["left", "fill"];
    var fileFormatsPanel_nav = fileFormatsPanel.add("listbox", undefined, ['AI','PDF', 'EPS', 'SVG', 'JPG', 'PNG', 'Scale']);
    fileFormatsPanel_nav.preferredSize.width = 75
    var fileFormatsPanel_innerwrap = fileFormatsPanel.add("group")
    fileFormatsPanel_innerwrap.alignment = ["fill", "fill"];
    fileFormatsPanel_innerwrap.orientation = ["stack"];

    // OPTIONSAITAB
    // ============
    var optionsAITab = fileFormatsPanel_innerwrap.add("group", undefined, {
        name: "optionsAITab"
    });
    optionsAITab.text = "AI";
    optionsAITab.orientation = "column";
    optionsAITab.alignChildren = ["left", "top"];
    optionsAITab.spacing = 10;
    optionsAITab.margins = 0;

    // AIOPTIONSPanel
    // ============
    var aiOptionsPanel = optionsAITab.add("panel", undefined, undefined, {
        name: "aiOptionsPanel"
    });
    aiOptionsPanel.text = "Options";
    aiOptionsPanel.preferredSize.width = 390;
    aiOptionsPanel.orientation = "column";
    aiOptionsPanel.alignChildren = ["left", "top"];
    aiOptionsPanel.spacing = panelSpacing;
    aiOptionsPanel.margins = panelMargins;

    // VERSIONAIGROUP
    // ==============
    var versionAIGroup = aiOptionsPanel.add("group", undefined, {
        name: "versionAIGroup"
    });
    versionAIGroup.preferredSize.width = 55;
    versionAIGroup.orientation = "row";
    versionAIGroup.alignChildren = ["left", "center"];
    versionAIGroup.spacing = 10;
    versionAIGroup.margins = 0;

    var versionAILabel = versionAIGroup.add("statictext", undefined, undefined, {
        name: "versionAILabel"
    });
    versionAILabel.text = "Version";
    versionAILabel.preferredSize.width = 60;

    var VersionAIDropdown_array = ["Illustrator CC", "-", "Legacy Formats", "Illustrator CS6", "Illustrator CS5", "Illustrator CS4", "Illustrator CS3", "Illustrator CS2", "Illustrator CS", "Illustrator 10", "Illustrator 9", "Illustrator 8"];
    var VersionAIDropdown = versionAIGroup.add("dropdownlist", undefined, undefined, {
        name: "VersionAIDropdown",
        items: VersionAIDropdown_array
    });
    VersionAIDropdown.selection = exportInfo.ai.VersionAI;
    VersionAIDropdown.preferredSize.width = 150;
    VersionAIDropdown.items[2].enabled=false; // Grey out items

    // AIOPTIONSPanel
    // ============
    var compatibelPDFAICheckbox = aiOptionsPanel.add("checkbox", undefined, undefined, {
        name: "compatibelPDFAICheckbox"
    });
    compatibelPDFAICheckbox.text = "Create PDF Compatibel File";
    compatibelPDFAICheckbox.value = exportInfo.ai.compatiblepdfAI;

    var includeLinkedAICheckbox = aiOptionsPanel.add("checkbox", undefined, undefined, {
        name: "includeLinkedAICheckbox"
    });
    includeLinkedAICheckbox.text = "Include Linked Files";
    includeLinkedAICheckbox.value = exportInfo.ai.includeLinkedAI;

    var embedICCProfilesAICheckbox = aiOptionsPanel.add("checkbox", undefined, undefined, {
        name: "embedICCProfilesAICheckbox"
    });
    embedICCProfilesAICheckbox.text = "Embed ICC Profiles";
    embedICCProfilesAICheckbox.value = exportInfo.ai.embedICCAI;

    var useCompressionAICheckbox = aiOptionsPanel.add("checkbox", undefined, undefined, {
        name: "useCompressionAICheckbox"
    });
    useCompressionAICheckbox.text = "Use Compression";
    useCompressionAICheckbox.value = exportInfo.ai.usecompressionAI;


    // OPTIONSPDFTAB
    // =============
    var optionsPDFTab = fileFormatsPanel_innerwrap.add("group", undefined, {
        name: "optionsPDFTab"
    });
    optionsPDFTab.text = "PDF";
    optionsPDFTab.orientation = "column";
    optionsPDFTab.alignChildren = ["fill", "top"];
    optionsPDFTab.spacing = 10;
    optionsPDFTab.margins = 0;

    // PDFOPTIONSPANEL
    // ===============
    var pdfOptionsPanel = optionsPDFTab.add("panel", undefined, undefined, {
        name: "pdfOptionsPanel"
    });
    pdfOptionsPanel.text = "Options";
    pdfOptionsPanel.preferredSize.width = 390;
    pdfOptionsPanel.orientation = "column";
    pdfOptionsPanel.alignChildren = ["left", "top"];
    pdfOptionsPanel.spacing = panelSpacing;
    pdfOptionsPanel.margins = panelMargins;
    // PDFPRESETPDFGROUP
    // =================
    var pdfPresetPDFGroup = pdfOptionsPanel.add("group", undefined, {
        name: "pdfPresetPDFGroup"
    });
    pdfPresetPDFGroup.preferredSize.width = 55;
    pdfPresetPDFGroup.orientation = "row";
    pdfPresetPDFGroup.alignChildren = ["left", "center"];
    pdfPresetPDFGroup.spacing = 10;
    pdfPresetPDFGroup.margins = 0;

    var pdfPresetsPDFLabel = pdfPresetPDFGroup.add("statictext", undefined, undefined, {
        name: "pdfPresetsPDFLabel"
    });
    pdfPresetsPDFLabel.text = "Adobe PDF Presets";
    pdfPresetsPDFLabel.preferredSize.width = 120;

    // var pdfPresetsPDFDropdown_array = ["Illustrator CC","Legacy Formats","Illustrator CS6","Illustrator CS5","Illustrator CS4","Illustrator CS3","Illustrator CS2","Illustrator CS","Illustrator 10","Illustrator 9","Illustrator 8"]; 
    var pdfPresetsPDFDropdown = pdfPresetPDFGroup.add("dropdownlist", undefined, undefined, {
        name: "pdfPresetsPDFDropdown",
        items: getPDFpresetList()
    });
    pdfPresetsPDFDropdown.selection = exportInfo.pdf.adobepresetPDF;
    pdfPresetsPDFDropdown.preferredSize.width = 150;

    // PDFOPTIONSPANEL
    // ===============
    var preserveEditingPDFCheckbox = pdfOptionsPanel.add("checkbox", undefined, undefined, {
        name: "preserveEditingPDFCheckbox"
    });
    preserveEditingPDFCheckbox.text = "Preserve Illustrator  Editing Capabalities";
    preserveEditingPDFCheckbox.value = exportInfo.pdf.preserveEditabilityPDF;

    var embedPageThumbnailsPDFCheckbox = pdfOptionsPanel.add("checkbox", undefined, undefined, {
        name: "embedPageThumbnailsPDFCheckbox"
    });
    embedPageThumbnailsPDFCheckbox.text = "Embed Page Thumbnails";
    embedPageThumbnailsPDFCheckbox.value = exportInfo.pdf.embedPageThumbnailsPDF;

    var optimizeFastWebPDFCheckbox = pdfOptionsPanel.add("checkbox", undefined, undefined, {
        name: "optimizeFastWebPDFCheckbox"
    });
    optimizeFastWebPDFCheckbox.text = "Optimize for Fast Web View";
    optimizeFastWebPDFCheckbox.value = exportInfo.pdf.optimizeviewPDF;

    var createAcrobatLayerPDFCheckbox = pdfOptionsPanel.add("checkbox", undefined, undefined, {
        name: "createAcrobatLayerPDFCheckbox"
    });
    createAcrobatLayerPDFCheckbox.text = "Create Acrobat Layers from Top-Level Layers";
    createAcrobatLayerPDFCheckbox.value = exportInfo.pdf.createlayersPDF;

    // OPTIONSEPSTAB
    // =============
    var optionsEPSTab = fileFormatsPanel_innerwrap.add("group", undefined, {
        name: "optionsEPSTab"
    });
    optionsEPSTab.text = "EPS";
    optionsEPSTab.orientation = "column";
    optionsEPSTab.alignChildren = ["fill", "top"];
    optionsEPSTab.spacing = 10;
    optionsEPSTab.margins = 0;

    // EPSOPTIONSPANEL
    // ===============
    var epsOptionsPanel = optionsEPSTab.add("panel", undefined, undefined, {
        name: "epsOptionsPanel"
    });
    epsOptionsPanel.text = "Options";
    epsOptionsPanel.preferredSize.width = 390;
    epsOptionsPanel.orientation = "column";
    epsOptionsPanel.alignChildren = ["left", "top"];
    epsOptionsPanel.spacing = panelSpacing;
    epsOptionsPanel.margins = panelMargins;

    // VERSIONEPSGROUP
    // ===============
    var versionEPSGroup = epsOptionsPanel.add("group", undefined, {
        name: "versionEPSGroup"
    });
    versionEPSGroup.preferredSize.width = 55;
    versionEPSGroup.orientation = "row";
    versionEPSGroup.alignChildren = ["left", "center"];
    versionEPSGroup.spacing = 10;
    versionEPSGroup.margins = 0;

    var versionEPSLabel = versionEPSGroup.add("statictext", undefined, undefined, {
        name: "versionEPSLabel"
    });
    versionEPSLabel.text = "Version";
    versionEPSLabel.preferredSize.width = 60;

    var VersionEPSDropdown_array = ["Illustrator CC EPS", "-", "Legacy Formats", "Illustrator CS6 EPS", "Illustrator CS5 EPS", "Illustrator CS4 EPS"];
    var VersionEPSDropdown = versionEPSGroup.add("dropdownlist", undefined, undefined, {
        name: "VersionEPSDropdown",
        items: VersionEPSDropdown_array
    });
    VersionEPSDropdown.selection = exportInfo.eps.VersionEPS;
    VersionEPSDropdown.items[2].enabled=false; // Grey out items


    // EMBEDFONTSEPSGROUP
    // ==================
    var embedFontsEPSGroup = epsOptionsPanel.add("group", undefined, {
        name: "embedFontsEPSGroup"
    });
    embedFontsEPSGroup.preferredSize.width = 55;
    embedFontsEPSGroup.orientation = "column";
    embedFontsEPSGroup.alignChildren = ["left", "center"];
    embedFontsEPSGroup.spacing = 5;
    embedFontsEPSGroup.margins = 0;

    var embedFontsEPSCheckbox = embedFontsEPSGroup.add("checkbox", undefined, undefined, {
        name: "embedFontsEPSCheckbox"
    });
    embedFontsEPSCheckbox.text = "Embed Fonts";
     embedFontsEPSCheckbox.value = exportInfo.eps.embedFontsEPS;

    var includeLinkedEPSCheckbox = embedFontsEPSGroup.add("checkbox", undefined, undefined, {
        name: "includeLinkedEPSCheckbox"
    });
    includeLinkedEPSCheckbox.text = "Include Linked Files";
    includeLinkedEPSCheckbox.value = exportInfo.eps.includeLinkedEPS;

    var includeThumbsEPSCheckbox = embedFontsEPSGroup.add("checkbox", undefined, undefined, {
        name: "includeThumbsEPSCheckbox"
    });
    includeThumbsEPSCheckbox.text = "Include Document Thumbnails";
    includeThumbsEPSCheckbox.value = exportInfo.eps.includeThumbsEPS

    var includeCmykinRGBEPSCheckbox = embedFontsEPSGroup.add("checkbox", undefined, undefined, {
        name: "includeCmykinRGBEPSCheckbox"
    });
    includeCmykinRGBEPSCheckbox.text = "Include CMYK Postscript in RGB Files";
    includeCmykinRGBEPSCheckbox.value = exportInfo.eps.includeCmykinRGBEPS;

    var compatiblePrintingEPSCHeckbox = embedFontsEPSGroup.add("checkbox", undefined, undefined, {
        name: "compatiblePrintingEPSCHeckbox"
    });
    compatiblePrintingEPSCHeckbox.text = "Compatible  Gradient and Gradient Mesh printing";
    compatiblePrintingEPSCHeckbox.value = exportInfo.eps.compatiblePrintingEPS;

    // ADOBEPOSTSCRIPTEPSGROUP
    // =======================
    var adobePostscriptEPSGroup = embedFontsEPSGroup.add("group", undefined, {
        name: "adobePostscriptEPSGroup"
    });
    adobePostscriptEPSGroup.orientation = "row";
    adobePostscriptEPSGroup.alignChildren = ["left", "center"];
    adobePostscriptEPSGroup.spacing = 10;
    adobePostscriptEPSGroup.margins = 0;

    var adobePostscripEPSLabel = adobePostscriptEPSGroup.add("statictext", undefined, undefined, {
        name: "adobePostscripEPSLabel"
    });
    adobePostscripEPSLabel.text = "Adobe PostscriptÂ®";

    var adobePostscriptEPSDropdown_array = ["LanguageLevel 2", "LanguageLevel 3"];
    var adobePostscriptEPSDropdown = adobePostscriptEPSGroup.add("dropdownlist", undefined, undefined, {
        name: "adobePostscriptEPSDropdown",
        items: adobePostscriptEPSDropdown_array
    });
    adobePostscriptEPSDropdown.selection = exportInfo.eps.adobeposttscriptEPS;
    adobePostscriptEPSDropdown.preferredSize.width = 125;


    // OPTIONSSVGTAB
    // =============
    var optionsSVGTab = fileFormatsPanel_innerwrap.add("group", undefined, {
        name: "optionsSVGTab"
    });
    optionsSVGTab.text = "SVG";
    optionsSVGTab.orientation = "column";
    optionsSVGTab.alignChildren = ["fill", "top"];
    optionsSVGTab.spacing = 10;
    optionsSVGTab.margins = 0;

    // SVGOPTIONSPANEL
    // ===============
    var svgOptionsPanel = optionsSVGTab.add("panel", undefined, undefined, {
        name: "svgOptionsPanel"
    });
    svgOptionsPanel.text = "Options";
    svgOptionsPanel.preferredSize.width = 390;
    svgOptionsPanel.orientation = "column";
    svgOptionsPanel.alignChildren = ["left", "top"];
    svgOptionsPanel.spacing = panelSpacing;
    svgOptionsPanel.margins = panelMargins;

    // STYLINGSVGGROUP
    // ===============
    var stylingSVGGroup = svgOptionsPanel.add("group", undefined, {
        name: "stylingSVGGroup"
    });
    stylingSVGGroup.preferredSize.width = 55;
    stylingSVGGroup.orientation = "row";
    stylingSVGGroup.alignChildren = ["left", "center"];
    stylingSVGGroup.spacing = 10;
    stylingSVGGroup.margins = 0;

    var StylingSVGLabel = stylingSVGGroup.add("statictext", undefined, undefined, {
        name: "StylingSVGLabel"
    });
    StylingSVGLabel.text = "Styling";
    StylingSVGLabel.preferredSize.width = 60;

    var StylingJPGDropdown_array = ["Internal CSS", "Inline Style", "Presentation Attributes"];
    var StylingSVGDropdown = stylingSVGGroup.add("dropdownlist", undefined, undefined, {
        name: "StylingSVGDropdown",
        items: StylingJPGDropdown_array
    });
    StylingSVGDropdown.selection = exportInfo.svg.StylingSVG;

    // FONTSVGGROUP
    // ============
    var fontSVGGroup = svgOptionsPanel.add("group", undefined, {
        name: "fontSVGGroup"
    });
    fontSVGGroup.orientation = "row";
    fontSVGGroup.alignChildren = ["left", "center"];
    fontSVGGroup.spacing = 10;
    fontSVGGroup.margins = 0;

    var fontLabel = fontSVGGroup.add("statictext", undefined, undefined, {
        name: "fontLabel"
    });
    fontLabel.text = "Font";
    fontLabel.preferredSize.width = 60;

    var FontsSVGDropdown_array = ["Convert To Outlines", "SVG"];
    var FontsSVGDropdown = fontSVGGroup.add("dropdownlist", undefined, undefined, {
        name: "FontsSVGDropdown",
        items: FontsSVGDropdown_array
    });
    FontsSVGDropdown.selection = exportInfo.svg.FontSVG;

    // IMAGESSVGGROUP
    // ==============
    var imagesSVGGroup = svgOptionsPanel.add("group", undefined, {
        name: "imagesSVGGroup"
    });
    imagesSVGGroup.orientation = "row";
    imagesSVGGroup.alignChildren = ["left", "center"];
    imagesSVGGroup.spacing = 10;
    imagesSVGGroup.margins = 0;

    var ImagesSVGLabel = imagesSVGGroup.add("statictext", undefined, undefined, {
        name: "ImagesSVGLabel"
    });
    ImagesSVGLabel.text = "Images";
    ImagesSVGLabel.preferredSize.width = 60;

    var imagesSVGDropdown_array = ["Preserve", "Embed", "Link"];
    var imagesSVGDropdown = imagesSVGGroup.add("dropdownlist", undefined, undefined, {
        name: "imagesSVGDropdown",
        items: imagesSVGDropdown_array
    });
    imagesSVGDropdown.selection = exportInfo.svg.imagesSVG;


    // OBJECTIDSVGGROUP
    // ==============
    var objectidSVGGroup = svgOptionsPanel.add("group", undefined, {
        name: "objectidSVGGroup"
    });
    objectidSVGGroup.orientation = "row";
    objectidSVGGroup.alignChildren = ["left", "center"];
    objectidSVGGroup.spacing = 10;
    objectidSVGGroup.margins = 0;

    var objectidSVGLabel = objectidSVGGroup.add("statictext", undefined, undefined, {
        name: "objectidSVGLabel"
    });
    objectidSVGLabel.text = "Object IDs";
    objectidSVGLabel.preferredSize.width = 60;

    var objectidSVGDropdown_array = ["Layer Names", "Minimal", "Unique"];
    var objectidSVGDropdown = objectidSVGGroup.add("dropdownlist", undefined, undefined, {
        name: "objectidSVGDropdown",
        items: objectidSVGDropdown_array
    });
    objectidSVGDropdown.selection = exportInfo.svg.objectidSVG;


    // DECIMALSVGGROUP
    // ===============
    var decimalSVGGroup = svgOptionsPanel.add("group", undefined, {
        name: "decimalSVGGroup"
    });
    decimalSVGGroup.preferredSize.width = 122;
    decimalSVGGroup.orientation = "row";
    decimalSVGGroup.alignChildren = ["left", "center"];
    decimalSVGGroup.spacing = 10;
    decimalSVGGroup.margins = 0;

    var decimalSVGLabel = decimalSVGGroup.add("statictext", undefined, undefined, {
        name: "decimalSVGLabel"
    });
    decimalSVGLabel.text = "Decimal";
    decimalSVGLabel.preferredSize.width = 60;

    var decimalSVGInput = decimalSVGGroup.add('edittext {properties: {name: "decimalSVGInput"}}');
    decimalSVGInput.preferredSize.width = 65;
    decimalSVGInput.text = exportInfo.svg.decimalSVG;


    // OPTIONSSVGGROUP
    // ===============
    var optionsSVGGroup = svgOptionsPanel.add("group", undefined, {
        name: "optionsSVGGroup"
    });
    optionsSVGGroup.preferredSize.width = 122;
    optionsSVGGroup.orientation = "row";
    optionsSVGGroup.alignChildren = ["left", "center"];
    optionsSVGGroup.spacing = 10;
    optionsSVGGroup.margins = 0;

    var spacerSVGoptions = optionsSVGGroup.add("statictext", undefined, undefined, {
        name: "spacerSVGoptions"
    });
    spacerSVGoptions.preferredSize.width = 60;

    var minimizeSVGCheckbox = optionsSVGGroup.add("checkbox", undefined, undefined, {
        name: "minimizeSVGCheckbox"
    });
    minimizeSVGCheckbox.text = "Minimize";
    minimizeSVGCheckbox.value = exportInfo.svg.minimizeSVG;

    var responsiveSVGCheckbox = optionsSVGGroup.add("checkbox", undefined, undefined, {
        name: "responsiveSVGCheckbox"
    });
    responsiveSVGCheckbox.text = "Responsive";
    responsiveSVGCheckbox.value = exportInfo.svg.responsiveSVG;


    // OPTIONSJPGTAB
    // =============
    var optionsJPGTab = fileFormatsPanel_innerwrap.add("group", undefined, {
        name: "optionsJPGTab"
    });
    optionsJPGTab.text = "JPG";
    optionsJPGTab.orientation = "column";
    optionsJPGTab.alignChildren = ["fill", "top"];
    optionsJPGTab.spacing = 10;
    optionsJPGTab.margins = 0;

    // JPGOPTIONSPANEL
    // ===============
    var jpgOptionsPanel = optionsJPGTab.add("panel", undefined, undefined, {
        name: "jpgOptionsPanel"
    });
    jpgOptionsPanel.text = "Options";
    jpgOptionsPanel.preferredSize.width = 390;
    jpgOptionsPanel.orientation = "column";
    jpgOptionsPanel.alignChildren = ["left", "top"];
    jpgOptionsPanel.spacing = panelSpacing;
    jpgOptionsPanel.margins = panelMargins;

    // COMPRESSIONMETHODJPGGROUP
    // =========================
    var compressionMethodJPGGroup = jpgOptionsPanel.add("group", undefined, {
        name: "compressionMethodJPGGroup"
    });
    compressionMethodJPGGroup.orientation = "row";
    compressionMethodJPGGroup.alignChildren = ["left", "center"];
    compressionMethodJPGGroup.spacing = 10;
    compressionMethodJPGGroup.margins = 0;

    var compressionMethodJPGLabel = compressionMethodJPGGroup.add("statictext", undefined, undefined, {
        name: "compressionMethodJPGLabel"
    });
    compressionMethodJPGLabel.text = "Compression Method";
    compressionMethodJPGLabel.preferredSize.width = 140;

    var compressionPresetsJPGDropdown_array = ["Baseline (Standard)", "Baseline Optimized", "Progressive"];
    var compressionPresetsJPGDropdown = compressionMethodJPGGroup.add("dropdownlist", undefined, undefined, {
        name: "compressionPresetsJPGDropdown",
        items: compressionPresetsJPGDropdown_array
    });
    compressionPresetsJPGDropdown.preferredSize.width = 110;
    compressionPresetsJPGDropdown.selection = exportInfo.jpg.compressionmethodJPG;

    var spacerJPGLabel = compressionMethodJPGGroup.add("statictext", undefined, undefined, {
        name: "spacerJPGLabel"
    });
    spacerJPGLabel.text = "  ";
    spacerJPGLabel.preferredSize.width = 2;

    var progressivescansJPGLabel = compressionMethodJPGGroup.add("statictext", undefined, undefined, {
        name: "progressivescansJPGLabel"
    });
    progressivescansJPGLabel.text = "Scans";
    progressivescansJPGLabel.preferredSize.width = 35;

    var progressivescansJPGDropdown_array = ["3", "4", "5"];
    var progressivescansJPGDropdown = compressionMethodJPGGroup.add("dropdownlist", undefined, undefined, {
        name: "progressivescansJPGDropdown",
        items: progressivescansJPGDropdown_array
    });
    progressivescansJPGDropdown.preferredSize.width = 50;
    progressivescansJPGDropdown.selection = exportInfo.jpg.progressivescansJPG;

    // ANTIALIASINGJPGGROUP
    // ====================
    var antialiasingJPGGroup = jpgOptionsPanel.add("group", undefined, {
        name: "antialiasingJPGGroup"
    });
    antialiasingJPGGroup.orientation = "row";
    antialiasingJPGGroup.alignChildren = ["left", "center"];
    antialiasingJPGGroup.spacing = 10;
    antialiasingJPGGroup.margins = 0;

    var antialiasingJPGLabel = antialiasingJPGGroup.add("statictext", undefined, undefined, {
        name: "antialiasingJPGLabel"
    });
    antialiasingJPGLabel.text = "Anti-aliasing";
    antialiasingJPGLabel.preferredSize.width = 140;

    var antialiasingJPGDropdown_array = ["None", "Type Optimized (Hinted)", "Art Optimized (Supersampling)"];
    var antialiasingJPGDropdown = antialiasingJPGGroup.add("dropdownlist", undefined, undefined, {
        name: "antialiasingJPGDropdown",
        items: antialiasingJPGDropdown_array
    });
    antialiasingJPGDropdown.selection = exportInfo.jpg.antialiasingJPG;

    // JPGOPTIONSPANEL
    // ===============
    var embedICCProfilesJPGCheckbox = jpgOptionsPanel.add("checkbox", undefined, undefined, {
        name: "embedICCProfilesJPGCheckbox"
    });
    embedICCProfilesJPGCheckbox.text = "Embed ICC Profiles";
    embedICCProfilesJPGCheckbox.value = exportInfo.jpg.embedICCJPG;

    // OPTIONSPNGTAB
    // =============
    var optionsPNGTab = fileFormatsPanel_innerwrap.add("group", undefined, {
        name: "optionsPNGTab"
    });
    optionsPNGTab.text = "PNG";
    optionsPNGTab.orientation = "column";
    optionsPNGTab.alignChildren = ["fill", "top"];
    optionsPNGTab.spacing = 10;
    optionsPNGTab.margins = 0;


    // PNGOPTIONSPANEL
    // ===============
    var pngOptionsPanel = optionsPNGTab.add("panel", undefined, undefined, {
        name: "pngOptionsPanel"
    });
    pngOptionsPanel.text = "Options";
    pngOptionsPanel.orientation = "column";
    pngOptionsPanel.alignChildren = ["left", "top"];
    pngOptionsPanel.spacing = panelSpacing;
    pngOptionsPanel.margins = panelMargins;

    // ANTIALIASINGPNGGROUP
    // ====================
    var antialiasingPNGGroup = pngOptionsPanel.add("group", undefined, {
        name: "antialiasingPNGGroup"
    });
    antialiasingPNGGroup.orientation = "row";
    antialiasingPNGGroup.alignChildren = ["left", "center"];
    antialiasingPNGGroup.spacing = 10;
    antialiasingPNGGroup.margins = 0;

    var antialiasingPNGLabel = antialiasingPNGGroup.add("statictext", undefined, undefined, {
        name: "antialiasingPNGLabel"
    });
    antialiasingPNGLabel.text = "Anit-aliasing";
    antialiasingPNGLabel.preferredSize.width = 120;

    var antialiasingPNGDropdown_array = ["None", "Type Optimized (Hinted)", "Art Optimized (Supersampling)"];
    var antialiasingPNGDropdown = antialiasingPNGGroup.add("dropdownlist", undefined, undefined, {
        name: "antialiasingPNGDropdown",
        items: antialiasingPNGDropdown_array
    });
    antialiasingPNGDropdown.selection = exportInfo.png.interlacedPNG;

    // OPTIONSSVGGROUP
    // ===============
    var optionsPNGGroup = pngOptionsPanel.add("group", undefined, {
        name: "optionsSVGGroup"
    });
    optionsPNGGroup.preferredSize.width = 122;
    optionsPNGGroup.orientation = "row";
    optionsPNGGroup.alignChildren = ["left", "center"];
    optionsPNGGroup.spacing = 10;
    optionsPNGGroup.margins = 0;

    var spacerPNGoptions = optionsPNGGroup.add("statictext", undefined, undefined, {
        name: "spacerPNGoptions"
    });
    spacerPNGoptions.preferredSize.width = 120;

    var interlacedPNGCheckbox = optionsPNGGroup.add("checkbox", undefined, undefined, {
        name: "interlacedPNGCheckbox"
    });
    interlacedPNGCheckbox.text = "Interlaced";
    interlacedPNGCheckbox.value = exportInfo.png.interlacedPNG

    // BACKGROUNDCOLORPNGGROUP
    // =======================
    var backgroundcolorPNGGroup = pngOptionsPanel.add("group", undefined, {
        name: "backgroundcolorPNGGroup"
    });
    backgroundcolorPNGGroup.orientation = "row";
    backgroundcolorPNGGroup.alignChildren = ["left", "center"];
    backgroundcolorPNGGroup.spacing = 10;
    backgroundcolorPNGGroup.margins = 0;

    var backgroundcolorPNGLabel = backgroundcolorPNGGroup.add("statictext", undefined, undefined, {
        name: "backgroundcolorPNGLabel"
    });
    backgroundcolorPNGLabel.text = "Background Color";
    backgroundcolorPNGLabel.preferredSize.width = 120;

    var backgroundcolorPNGDropdown_array = ["Transparent", "Black", "White"];
    var backgroundcolorPNGDropdown = backgroundcolorPNGGroup.add("dropdownlist", undefined, undefined, {
        name: "backgroundcolorPNGDropdown",
        items: backgroundcolorPNGDropdown_array
    });
    backgroundcolorPNGDropdown.selection = exportInfo.png.backgroundColorPNG;



    // OPTIONSSCALETAB
    // ===============
    var optionsScaleTab = fileFormatsPanel_innerwrap.add("group", undefined, {name: "optionsScaleTab"}); 
        optionsScaleTab.text = "Scale"; 
        optionsScaleTab.orientation = "column"; 
        optionsScaleTab.alignChildren = ["fill","top"]; 
        optionsScaleTab.spacing = 10; 
        optionsScaleTab.margins = 0; 


    // FILEFORMATSPANEL
    // ================
    fileFormatsPanel_tabs = [optionsAITab, optionsPDFTab, optionsEPSTab, optionsSVGTab, optionsJPGTab, optionsPNGTab, optionsScaleTab];

    for (var i = 0; i < fileFormatsPanel_tabs.length; i++) {
        fileFormatsPanel_tabs[i].alignment = ["fill", "fill"];
        fileFormatsPanel_tabs[i].visible = false;
    }

    fileFormatsPanel_nav.onChange = showTab_fileFormatsPanel;

    function showTab_fileFormatsPanel() {
        if (fileFormatsPanel_nav.selection !== null) {
            for (var i = fileFormatsPanel_tabs.length - 1; i >= 0; i--) {
                fileFormatsPanel_tabs[i].visible = false;
            }
            fileFormatsPanel_tabs[fileFormatsPanel_nav.selection.index].visible = true;
        }
    }

    fileFormatsPanel_nav.selection = exportInfo.activeTab;
    showTab_fileFormatsPanel()

    // SCALEOPTIONSPANEL
    // =================
    var scaleOptionsPanel = optionsScaleTab.add("panel", undefined, undefined, {name: "scaleOptionsPanel"}); 
        scaleOptionsPanel.text = "Options"; 
        scaleOptionsPanel.orientation = "column"; 
        scaleOptionsPanel.alignChildren = ["left","top"]; 
        scaleOptionsPanel.spacing = panelSpacing; 
        scaleOptionsPanel.margins = panelMargins;

    var customScaleCheckbox = scaleOptionsPanel.add("checkbox", undefined, undefined, {name: "customScaleCheckbox"}); 
        customScaleCheckbox.text = "Custom Scale"; 
        customScaleCheckbox.value = exportInfo.scale.customScale; 
        customScaleCheckbox.helpTip = "When left off, exported image dimensions is 1000 pixels wide."; 


    // SCALETYPEGROUP
    // ==============
    var scaleTypeGroup = scaleOptionsPanel.add("group", undefined, {name: "scaleTypeGroup"}); 
        scaleTypeGroup.orientation = "column"; 
        scaleTypeGroup.alignChildren = ["left","center"]; 
        scaleTypeGroup.spacing = 5; 
        scaleTypeGroup.margins = 0; 
        scaleTypeGroup.enabled = false; 

    // LABELSCALEGROUP
    // ===============
    var labelScaleGroup = scaleTypeGroup.add("group", undefined, {name: "labelScaleGroup"}); 
        labelScaleGroup.orientation = "row"; 
        labelScaleGroup.alignChildren = ["left","center"]; 
        labelScaleGroup.spacing = 0; 
        labelScaleGroup.margins = 0; 

    var scaleSizeLabel = labelScaleGroup.add("statictext", undefined, undefined, {name: "scaleSizeLabel"}); 
        scaleSizeLabel.text = "Scale"; 
        scaleSizeLabel.preferredSize.width = 120; 

    var spacer = labelScaleGroup.add("statictext", undefined, undefined, {name: "spacer"}); 
        spacer.text = " "; 
        spacer.preferredSize.width = 120; 

    var SuffixLabel = labelScaleGroup.add("statictext", undefined, undefined, {name: "SuffixLabel"}); 
        SuffixLabel.text = "Suffix"; 
        SuffixLabel.preferredSize.width = 70; 

    // GROUP1
    // ======
    var group1 = scaleTypeGroup.add("group", undefined, {name: "group1"}); 
        group1.orientation = "row"; 
        group1.alignChildren = ["left","center"]; 
        group1.spacing = 0; 
        group1.margins = 0; 

    var scaleSizesInput = group1.add('edittext {properties: {name: "scaleSizesInput"}}'); 
        scaleSizesInput.preferredSize.width = 150; 
        scaleSizesInput.text = exportInfo.scale.scaleSizes; 
        scaleSizesInput.helpTip = "Select or specify the scale of the exported image. Values need to be devided by a dash ie '-''. Scale by width, height, resolution or scale. Width and Height are pixels, scale is percentage."; 
    // SCALETYPEGROUP1
    // ===============
    // var scaleTypeGroup1 = group1.add("group", undefined, {name: "scaleTypeGroup1"}); 
    //     scaleTypeGroup1.orientation = "row"; 
    //     scaleTypeGroup1.alignChildren = ["left","center"]; 
    //     scaleTypeGroup1.spacing = 10; 
    //     scaleTypeGroup1.margins = 0; 

    var scaleTypeDropdown_array = ["Width","Height", "Resolution", "Factor"]; 
    var scaleTypeDropdown = group1.add("dropdownlist", undefined, undefined, {name: "scaleTypeDropdown", items: scaleTypeDropdown_array}); 
        scaleTypeDropdown.selection = 0; 
        scaleTypeDropdown.preferredSize.width = 80; 
        scaleTypeDropdown.selection = exportInfo.scale.scaleType;
        scaleTypeDropdown.helpTip = "Select or specify the scale of the exported image. Values need to be separated by a dash ie '-'. Scale by width, height, resolution or scale. Width and Height are pixels, scale is percentage."; 

    // GROUP1
    // ======
    var spacer1 = group1.add("statictext", undefined, undefined, {name: "spacer1"}); 
        spacer1.text = " "; 
        spacer1.preferredSize.width = 10; 

    var suffixInput = group1.add('edittext {properties: {name: "suffixInput"}}'); 
        // suffixInput.text = "Suffix"; 
        suffixInput.preferredSize.width = 100; 
        suffixInput.text = exportInfo.scale.suffix; 
        suffixInput.helpTip = "Text added at the end of the file name."; 
        

    // DIALOGBTNS
    // ==========
    var dialogBtns = settingsExport.add("group", undefined, {
        name: "dialogBtns"
    });
    dialogBtns.preferredSize.width = 480;
    dialogBtns.orientation = "row";
    dialogBtns.alignChildren = ["right", "center"];
    dialogBtns.spacing = 10;
    dialogBtns.margins = 0;

    var cancel = dialogBtns.add("button", undefined, undefined, {
        name: "cancel"
    });
    cancel.text = "Cancel";

    var ok = dialogBtns.add("button", undefined, undefined, {
        name: "ok"
    });
    ok.text = "Ok";




    // dialog code
    ok.onClick = function(exportInfo) {
        var settings = getSettings(exportInfo);
        var saveJson = saveJsonPresetDoc(settings, settingsFile);
        if (saveJson) {
            settingsExport.close(runButtonID);
        }
    }


    cancel.onClick = function() {
        settingsExport.close(cancelButtonID);
    }

    function getPDFpresetList() {
        var pdfPresets = [];
        // pdfPresetsPDFDropdown.add("item", "yes")
        for (i = 0; i < app.PDFPresetsList.length; i++) {
            // Somehow illustrator need push and not add like photoshop uses to populate list??
            pdfPresets.push(app.PDFPresetsList[i])
        }
        return pdfPresets

    }

    // adjut inputs between 0-5
    decimalSVGInput.onChange = function() {
        if (decimalSVGInput.text > 5) {
            decimalSVGInput.text = 5;
        }
        if (decimalSVGInput.text <= 0) {
            decimalSVGInput.text = 1; // returns error when saving > also destroys logo
        }
    }
    // Reset dropdown to 0 if users picks greyed out option
    VersionAIDropdown.onChange = function() {
        if (VersionAIDropdown.selection == null) {
            VersionAIDropdown.selection = 0;
        }
    }
    VersionEPSDropdown.onChange = function() {
        if (VersionEPSDropdown.selection == null) {
            VersionEPSDropdown.selection = 0;
        }
    }

    // show hide progressive scans dropdown
    function showDD_progressivescansJPG() {
        if (compressionPresetsJPGDropdown.selection !== null) {
            if(compressionPresetsJPGDropdown.selection.index == 2) {
                progressivescansJPGDropdown.visible = true;
                progressivescansJPGLabel.visible = true;
            } else {
                progressivescansJPGDropdown.visible = false;
                progressivescansJPGLabel.visible = false;
            }
        }
    }
    showDD_progressivescansJPG()
    compressionPresetsJPGDropdown.onChange = function(){
        showDD_progressivescansJPG()
    }

    function customScalingCheck(){
        // alert(customScaleCheckbox.value)
        if (customScaleCheckbox.value == true) {
            scaleTypeGroup.enabled = true;
        } else {
            scaleTypeGroup.enabled = false;
        }
    }
    customScaleCheckbox.onClick = function() {
        customScalingCheck()
    }
    customScalingCheck()

    scaleTypeDropdown.onChange = function(){
        var selIndex = scaleTypeDropdown.selection.index;
        if (selIndex == 0) suffixInput.text = 'w';
        if (selIndex == 1) suffixInput.text = 'h';
        if (selIndex == 2) suffixInput.text = 'dpi';
        if (selIndex == 3) suffixInput.text = '@x';
    }
    // in case we double clicked the file
    // app.bringToFront();
    settingsExport.show();
    settingsExport.center();

    settingsExport.active = true;

    // $.sleep(2000)
    // alert("yeah")

    // Call main function from getselected, we can reuse scripts
    // var ScriptFilePath = Folder($.fileName).parent.fsName;

    function saveJsonPresetDoc(exportInfo, settingsFile) {
        // var extensionRoot = $.fileName.split('/').slice(0, -2).join('/') + '/';
        // var presetFilePath = new File(extensionRoot + '/presets_json/'+ exportInfo.docName+'.json');
        var presetFilePath = new File(extensionRoot + settingsFile);
        presetFilePath.open("w");
        presetFilePath.write(JSON.stringify(exportInfo));
        presetFilePath.close();
        // getJsonPresetFileNames(exportInfo);
        return presetFilePath
    }

    function getSettings(exportInfo) {
        // alert(exportInfo.scale.customScale)
        // alert(customScaleCheckbox.value)
        if (customScaleCheckbox.value==false){
                var customScaleCb = false;
                var scaleSizesInpt = "1000";
                var scaleTypeDd = 0;
                var suffixInpt = "";
        } else {
                var customScaleCb = customScaleCheckbox.value;
                var scaleSizesInpt = scaleSizesInput.text;
                var scaleTypeDd = scaleTypeDropdown.selection.index;
                var suffixInpt = suffixInput.text;
        }
        // alert(exportInfo)
        exportInfo = {
            ai: {
                VersionAI: VersionAIDropdown.selection.index,
                compatiblepdfAI: compatibelPDFAICheckbox.value,
                includeLinkedAI: includeLinkedAICheckbox.value,
                embedICCAI: embedICCProfilesAICheckbox.value,
                usecompressionAI: useCompressionAICheckbox.value,
            },
            pdf: {
                adobepresetPDF: pdfPresetsPDFDropdown.selection.index,
                preserveEditabilityPDF: preserveEditingPDFCheckbox.value,
                embedPageThumbnailsPDF: embedPageThumbnailsPDFCheckbox.value,
                optimizeviewPDF: optimizeFastWebPDFCheckbox.value,
                createlayersPDF: createAcrobatLayerPDFCheckbox.value,
            },
            eps: {
                VersionEPS: VersionEPSDropdown.selection.index,
                embedFontsEPS: embedFontsEPSCheckbox.value,
                includeLinkedEPS: includeLinkedEPSCheckbox.value,
                includeThumbsEPS: includeThumbsEPSCheckbox.value,
                includeCmykinRGBEPS: includeCmykinRGBEPSCheckbox.value,
                compatiblePrintingEPS: compatiblePrintingEPSCHeckbox.value,
                adobeposttscriptEPS: adobePostscriptEPSDropdown.selection.index,
            },
            svg: {
                StylingSVG: StylingSVGDropdown.selection.index,
                FontSVG: FontsSVGDropdown.selection.index,
                imagesSVG: imagesSVGDropdown.selection.index,
                objectidSVG: objectidSVGDropdown.selection.index,
                decimalSVG: parseInt(decimalSVGInput.text),
                minimizeSVG: minimizeSVGCheckbox.value,
                responsiveSVG: responsiveSVGCheckbox.value,
            },
            jpg: {
                compressionmethodJPG: compressionPresetsJPGDropdown.selection.index,
                progressivescansJPG: progressivescansJPGDropdown.selection.index,
                antialiasingJPG: antialiasingJPGDropdown.selection.index,
                embedICCJPG: embedICCProfilesJPGCheckbox.value,
            },
            png: {
                antialiasingPNG: antialiasingPNGDropdown.selection.index,
                interlacedPNG: interlacedPNGCheckbox.value,
                backgroundColorPNG: backgroundcolorPNGDropdown.selection.index,
            },
             scale: {
                // customScale: customScaleCheckbox.value,
                // scaleSizes: scaleSizesInput.text,
                // scaleType: scaleTypeDropdown.selection.index,
                // suffix: suffixInput.text,
                customScale: customScaleCb,
                scaleSizes: scaleSizesInpt,
                scaleType: scaleTypeDd,
                suffix: suffixInpt,
            },
            activeTab: fileFormatsPanel_nav.selection.index,
        }
        // }.svg.StylingSVG = StylingJPGDD.selection.index;
        // exportInfo.svg.FontSVG = FontJPGDD.selection.index;
        // exportInfo.svg.imagesSVG= imagesSVGDropdown.selection.index;
        // exportInfo.svg.decimalSVGInput = decimalSVGInput.text;
        return exportInfo
    }
}



///////////////////////////////////////////////////////////////////////////////
// Function: getExtensionRootPath
// Usage: return list of file names
// Input: folder
// Return: list of filenames
///////////////////////////////////////////////////////////////////////////////
function getExtensionRootPath() {

    extensionRoot = $.fileName.split('/').slice(0, -2).join('/') + '/';
    var folderPath = extensionRoot;
    if (!Folder(folderPath).exists) {
        alert("There is no Root folder with that name", "Warning")
    } else {
        return folderPath
    }
}


///////////////////////////////////////////////////////////////////////////////
// Function: loadSettings
// Usage: return settings read from settings.json
// Input: filepath
// Return: list of parsed json settings
///////////////////////////////////////////////////////////////////////////////
function loadSettings() {
    // var d = exportInfo;
    // alert(folderPath)
    var settingsFilePath = extensionRoot + settingsFile;

    // we cant reach CEP in ISX
    // var d = readFile(filePath, !0);

    // load file with JSX
    // source: https://community.adobe.com/t5/photoshop-ecosystem-discussions/open-json-file-and-parse-it-extendscript/m-p/8599620
    var scriptFile = File(settingsFilePath);
    scriptFile.open('r');
    var d = scriptFile.read();
    scriptFile.close();
    var d = JSON.parse(d);
    return d
}

data = loadSettings()
// alert(data.svg.decimalSVG)
showDialog(data, extensionRoot)